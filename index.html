<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>8Bitâ€™s Adventure</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <style>
    canvas { background: #737373; display: block; margin: 2em auto; }
  </style>
</head>
<body>
  <canvas id="game" width="640" height="480"></canvas>
  <script>
    // Canvas setup
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');

    // Character setup
    let x = 300, y = 200;
    const speed = 10;
    const size = 100;

    // Background image setup
    let bgReady = false;
    const bgImg = new Image();
    bgImg.src = "arcadebg.png";
    bgImg.onload = function() {
      bgReady = true;
    };

    // Character image setup (optional)
    const useImage = true;
    const img = new Image();
    img.src = '8bit.png';

    // Wall definitions (edit these to match your background art)
    const walls = [
      { x: 0, y: 0, width: 640, height: 32 },         // Top wall
      { x: 0, y: 448, width: 640, height: 32 },       // Bottom wall
      { x: 0, y: 0, width: 32, height: 480 },         // Left wall
      { x: 608, y: 0, width: 32, height: 480 },       // Right wall
      // Example wall: { x: 200, y: 100, width: 100, height: 50 }
    ];

    // Collision detection
    function isCollidingWithWall(newX, newY, size) {
      for (const wall of walls) {
        if (
          newX < wall.x + wall.width &&
          newX + size > wall.x &&
          newY < wall.y + wall.height &&
          newY + size > wall.y
        ) {
          return true;
        }
      }
      return false;
    }

    // Draw everything
   function draw() {
  if (!bgReady) return; // Only draw after background image is loaded
  ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);

  // Draw walls and character after background
  // (leave as in your current code)
  ctx.fillStyle = "rgba(0,0,0,0.3)";
  for (const wall of walls) {
    ctx.fillRect(wall.x, wall.y, wall.width, wall.height);
  }

  if (useImage && img.complete && img.naturalWidth > 0) {
    ctx.drawImage(img, x, y, size, size);
  } else {
    ctx.fillStyle = "#0090ff";
    ctx.fillRect(x, y, size, size);
  }
}

// Only call draw after the background image is loaded
bgImg.onload = function() {
  bgReady = true;
  draw();
};
      // Draw walls (semi-transparent, for debugging)
      ctx.fillStyle = "rgba(0,0,0,0.3)";
      for (const wall of walls) {
        ctx.fillRect(wall.x, wall.y, wall.width, wall.height);
      }

      // Draw character (image or blue square)
      if (useImage && img.complete && img.naturalWidth > 0) {
        ctx.drawImage(img, x, y, size, size);
      } else {
        ctx.fillStyle = "#0090ff";
        ctx.fillRect(x, y, size, size);
      }
    }

    // Handle arrow key movement with collision
    window.addEventListener('keydown', function(e) {
      let nextX = x, nextY = y;
      if (e.key === 'ArrowLeft') nextX -= speed;
      if (e.key === 'ArrowRight') nextX += speed;
      if (e.key === 'ArrowUp') nextY -= speed;
      if (e.key === 'ArrowDown') nextY += speed;
      if (!isCollidingWithWall(nextX, nextY, size)) {
        x = nextX;
        y = nextY;
      }
      draw();
    });

    // Initial draw (when images are loaded, or immediately)
    function initialDraw() { draw(); }
    if (useImage) {
      img.onload = initialDraw;
    } else {
      initialDraw();
    }
    if (bgReady) draw();
    else bgImg.onload = draw;
  </script>
</body>
</html>
